# Apple App Review - UGC 안전 기능 가이드

본 문서는 RunOn 앱의 사용자 생성 콘텐츠(UGC) 안전 기능에 대한 상세 설명입니다.
Apple Guideline 2.1 요구사항에 대한 답변을 제공합니다.

---

## 📋 요약

RunOn 앱은 사용자 생성 콘텐츠에 대한 다음 4가지 안전 기능을 모두 구현하고 있습니다:

1. ✅ **부적절한 콘텐츠 필터링 시스템**
2. ✅ **사용자 신고 메커니즘**
3. ✅ **사용자 차단 메커니즘**
4. ✅ **24시간 내 신고 조치 시스템**

---

## 1️⃣ 부적절한 콘텐츠 필터링 방법

### 구현 위치
- **서비스 파일**: `services/contentFilterService.js`
- **적용 위치**: 게시글 작성 시 (`screens/PostCreateScreen.js`), 댓글 작성 시 (`screens/PostDetailScreen.js`)

### 작동 방식

#### Level 1 (심각) - 즉시 차단
다음과 같은 부적절한 콘텐츠는 게시 전에 자동으로 차단됩니다:
- 심각한 욕설: 시발, 씨발, 개새끼, 병신 등
- 성적 표현: 섹스, 성교, 자지, 보지 등
- 폭력 관련: 죽여, 죽일, 때려, 패서, 참수 등
- 혐오 표현: 한남충, 김치녀 등

**사용자 경험**: 부적절한 단어가 포함된 게시글/댓글은 작성 시 즉시 차단되며, "부적절한 콘텐츠가 포함되어 있어 게시할 수 없습니다" 메시지가 표시됩니다.

#### Level 2 (경미) - 경고 후 선택 허용
경미한 부적절한 표현은 경고 메시지와 함께 사용자에게 선택권을 제공합니다:
- 경미한 표현: 바보, 멍청이, 등신, 찐따, 호구, 젠장, 미친 등

**사용자 경험**: 경미한 부적절한 단어가 포함된 경우, "부적절한 단어가 포함되어 있습니다. 계속 작성하시겠습니까?" 메시지가 표시되며 사용자가 선택할 수 있습니다.

### 앱 내 확인 방법
1. 앱 실행
2. 커뮤니티 탭 이동
3. 게시글 작성 버튼 클릭
4. 부적절한 단어(예: "시발")를 포함한 게시글 작성 시도
5. 즉시 차단 메시지 확인

---

## 2️⃣ 부적절한 콘텐츠 신고 메커니즘

### 구현 위치
- **서비스 파일**: `services/reportService.js`
- **UI 위치**: 
  - 게시글 신고: `screens/PostDetailScreen.js` (헤더 우측 신고 아이콘)
  - 댓글 신고: `screens/PostDetailScreen.js` (댓글 길게 누르기)
  - 사용자 신고: `screens/ParticipantScreen.js` (프로필 화면)

### 작동 방식

#### 게시글 신고
1. **접근 방법**: 게시글 상세 화면 헤더 우측의 경고 아이콘(⚠️) 클릭
2. **신고 사유 선택**: 
   - 스팸/광고
   - 부적절한 콘텐츠
   - 혐오 표현
   - 성적 콘텐츠
   - 폭력/위협
   - 기타
3. **추가 설명 입력** (선택사항)
4. **신고 제출**: 신고가 Firestore `reports` 컬렉션에 저장되고 관리자에게 이메일 알림 전송

#### 댓글 신고
1. **접근 방법**: 댓글을 길게 누르기 (Long Press)
2. **신고 사유 선택** (게시글 신고와 동일)
3. **신고 제출**

#### 사용자 신고
1. **접근 방법**: 사용자 프로필 화면에서 신고 버튼 클릭
2. **신고 사유 선택**
3. **신고 제출**

### 앱 내 확인 방법
1. 앱 실행
2. 커뮤니티 탭 이동
3. 게시글 클릭하여 상세 화면 진입
4. 헤더 우측 경고 아이콘(⚠️) 클릭
5. 신고 사유 선택 후 제출

---

## 3️⃣ 악의적인 사용자 차단 메커니즘

### 구현 위치
- **서비스 파일**: `services/blacklistService.js`
- **UI 위치**: 
  - 사용자 프로필 화면: `screens/ParticipantScreen.js`
  - 차단 관리 화면: `screens/BlacklistManagementScreen.js`

### 작동 방식

#### 사용자 차단
1. **접근 방법**: 
   - 모임 참여자 목록에서 사용자 프로필 클릭
   - 또는 사용자 프로필 화면에서 "차단" 버튼 클릭
2. **차단 확인**: "이 사용자를 차단하시겠습니까?" 확인 메시지 표시
3. **차단 실행**: 
   - 양방향 차단 처리 (차단한 사용자와 차단당한 사용자 모두 서로를 차단)
   - 차단된 사용자와 함께 있는 모든 모임에서 자동 탈퇴
   - 최대 3명까지 차단 가능
4. **차단 효과**:
   - 차단된 사용자의 게시글/댓글이 표시되지 않음
   - 차단된 사용자와의 모임 참여 불가
   - 차단된 사용자와의 채팅 불가

#### 차단 관리
1. **접근 방법**: 설정 화면 → 차단 관리
2. **기능**: 차단된 사용자 목록 확인 및 차단 해제

### 앱 내 확인 방법
1. 앱 실행
2. 모임 상세 화면에서 참여자 목록 확인
3. 특정 사용자 프로필 클릭
4. "차단" 버튼 클릭
5. 차단 확인 및 실행

---

## 4️⃣ 24시간 내 신고 조치 시스템

### 구현 위치
- **Cloud Functions**: `functions/index.js`
- **자동 처리 스케줄러**: `checkPendingReports` (1시간마다 실행)
- **이메일 알림**: `onReportCreated` (신고 접수 시 즉시 실행)

### 작동 방식

#### 신고 접수 프로세스
1. **신고 접수**: 사용자가 신고 제출
2. **즉시 조치**:
   - Firestore `reports` 컬렉션에 신고 저장
   - `actionDeadline` 필드 설정 (신고 접수 시간 + 24시간)
   - 관리자에게 이메일 알림 전송 (`dlrhdkgml12@gmail.com`)
   - 이메일에는 신고 상세 정보, Firestore 링크, 24시간 내 조치 필요 경고 포함

#### 자동 처리 시스템
1. **스케줄러 실행**: 매시간 정각에 실행 (`0 * * * *`)
2. **24시간 경과 신고 확인**: `actionDeadline`이 현재 시간 이전인 미처리 신고 조회
3. **자동 조치**:
   - **게시글 신고**: 게시글 및 관련 이미지 자동 삭제
   - **댓글 신고**: 댓글 자동 삭제
   - **사용자 신고 횟수 증가**: 신고된 사용자의 `reportCount` 증가
   - **계정 정지**: 신고 횟수 3회 이상 시 자동 계정 정지
4. **신고 상태 업데이트**: `status: 'action_taken'`, `autoActionTaken: true`
5. **사용자 알림**: 콘텐츠 삭제 또는 계정 정지 알림 전송

#### 관리자 수동 조치
- **Firebase Console**: 신고 접수 이메일의 링크를 통해 Firestore에서 신고 확인
- **수동 처리**: 관리자가 신고를 검토하고 수동으로 콘텐츠 삭제 또는 사용자 추방 가능
- **24시간 내 조치**: 이메일 알림을 통해 관리자가 24시간 내에 수동 조치 가능

### 조치 타임라인
- **0시간**: 신고 접수, 이메일 알림 전송
- **0-24시간**: 관리자 수동 조치 가능 (이메일 알림 확인)
- **24시간**: 자동 처리 스케줄러 실행, 미처리 신고 자동 조치
- **24시간 이후**: 신고 횟수 3회 이상 사용자 자동 계정 정지

### 앱 내 확인 방법
1. 신고 제출
2. 관리자 이메일(`dlrhdkgml12@gmail.com`) 확인
3. Firebase Console에서 신고 확인
4. 24시간 후 자동 처리 확인 (Firestore에서 `status: 'action_taken'` 확인)

---

## 📧 관리자 연락처

- **이메일**: dlrhdkgml12@gmail.com
- **신고 접수**: 신고 시 자동으로 이메일 알림 전송
- **응답 시간**: 24시간 내 조치 보장

---

## 🔗 Firebase Console 접근

신고 내역은 다음 경로에서 확인할 수 있습니다:
- **Firestore**: `reports` 컬렉션
- **사용자 정보**: `users` 컬렉션 (신고 횟수, 계정 정지 상태 확인)

---

## 📝 추가 정보

### 신고 사유 목록
1. 스팸/광고
2. 부적절한 콘텐츠
3. 혐오 표현
4. 성적 콘텐츠
5. 폭력/위협
6. 기타

### 차단 제한
- 최대 3명까지 차단 가능
- 차단 해제는 설정 화면에서 가능

### 계정 정지 기준
- 신고 횟수 3회 이상 시 자동 계정 정지
- 정지된 계정은 앱 사용 불가

---

## ✅ Apple Guideline 2.1 준수 확인

| 요구사항 | 구현 여부 | 확인 방법 |
|---------|---------|----------|
| 부적절한 콘텐츠 필터링 | ✅ | 게시글 작성 시 부적절한 단어 입력 시도 |
| 사용자 신고 메커니즘 | ✅ | 게시글/댓글/사용자 신고 기능 사용 |
| 사용자 차단 메커니즘 | ✅ | 사용자 프로필에서 차단 기능 사용 |
| 24시간 내 조치 | ✅ | 신고 접수 후 24시간 내 자동 처리 또는 관리자 수동 조치 |

---

**문서 작성일**: 2025년 1월  
**앱 버전**: 최신 버전  
**담당자**: RunOn 개발팀  
**연락처**: dlrhdkgml12@gmail.com

